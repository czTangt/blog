<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>IDA 配置和使用 - czTang</title><meta name=author content="czTang"><meta name=description content="记录一下 IDA 的使用。
"><meta name=keywords content='config'><meta itemprop=name content="IDA 配置和使用"><meta itemprop=description content="记录一下 IDA 的使用。"><meta itemprop=datePublished content="2024-11-20T16:17:43+08:00"><meta itemprop=dateModified content="2024-12-01T20:53:19+08:00"><meta itemprop=wordCount content="2650"><meta itemprop=keywords content="Config"><meta property="og:url" content="https://czTangt.github.io/blog/posts/config/ida/"><meta property="og:site_name" content="czTang"><meta property="og:title" content="IDA 配置和使用"><meta property="og:description" content="记录一下 IDA 的使用。"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-20T16:17:43+08:00"><meta property="article:modified_time" content="2024-12-01T20:53:19+08:00"><meta property="article:tag" content="Config"><meta name=twitter:card content="summary"><meta name=twitter:title content="IDA 配置和使用"><meta name=twitter:description content="记录一下 IDA 的使用。"><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=https://nuthecz.oss-cn-hangzhou.aliyuncs.com/file/202410312135963.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://czTangt.github.io/blog/posts/config/ida/ title="IDA 配置和使用 - czTang"><link rel=prev type=text/html href=https://czTangt.github.io/blog/posts/course/compilers-lab/ title="Compilers Lab"><link rel=next type=text/html href=https://czTangt.github.io/blog/posts/android/elf/ title="ELF 解析"><link rel=stylesheet href=/blog/css/config.min.css><link rel=stylesheet href=/blog/css/style.min.css><link rel=preload href=/blog/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/blog/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/blog/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/blog/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"IDA 配置和使用","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/czTangt.github.io\/blog\/posts\/config\/ida\/"},"genre":"posts","keywords":"config","wordcount":2650,"url":"https:\/\/czTangt.github.io\/blog\/posts\/config\/ida\/","datePublished":"2024-11-20T16:17:43+08:00","dateModified":"2024-12-01T20:53:19+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"czTang"},"description":""}</script><script src=/blog/js/head/color-scheme.min.js></script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/blog/ title=czTang><span class=header-title-pre><i class='fa fa-coffee'>&nbsp</i></span><span class=header-title-text>czTang</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/blog/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/blog/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/blog/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/blog/about/><i class="fa-solid fa-user fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=搜索文章标题或内容…… id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/blog/ title=czTang><span class=header-title-pre><i class='fa fa-coffee'>&nbsp</i></span><span class=header-title-text>czTang</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容…… id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/blog/archives/><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> 归档</a></li><li class=menu-item><a class=menu-link href=/blog/categories/><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> 分类</a></li><li class=menu-item><a class=menu-link href=/blog/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> 标签</a></li><li class=menu-item><a class=menu-link href=/blog/about/><i class="fa-solid fa-user fa-fw fa-sm" aria-hidden=true></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title=合集>Config</span>
<span class=collection-count>7</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/blog/posts/config/git/ title="Some About Git">Some About Git</a></li><li class=collection-item><a href=/blog/posts/config/fixit/ title="Fixit 配置">Fixit 配置</a></li><li class=collection-item><a href=/blog/posts/config/android-studio/ title="Android Studio 配置">Android Studio 配置</a></li><li class=collection-item><span class=active title="IDA 配置和使用">IDA 配置和使用</span></li><li class=collection-item><a href=/blog/posts/config/android-phone/ title=安卓手机配置>安卓手机配置</a></li><li class=collection-item><a href=/blog/posts/config/vscode/ title="VsCode 配置和使用">VsCode 配置和使用</a></li><li class=collection-item><a href=/blog/posts/config/docker/ title=Docker>Docker</a></li></ul><div class=collection-nav-simple><a href=/blog/posts/config/android-studio/ class=collection-nav-item rel=prev title="Android Studio 配置"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>4/7</span><a href=/blog/posts/config/android-phone/ class=collection-nav-item rel=next title=安卓手机配置><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>IDA 配置和使用</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/czTangt title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=/blog/images/avatar.jpg alt=czTang height=16 width=16>&nbsp;czTang</a></span><span class=post-included-in>&nbsp;收录于 <a href=/blog/categories/config/ class=post-category title="分类 - Config"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Config</a> 和 <a href=/blog/collections/config/ class=post-collection title="合集 - Config"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Config</a></span></div><div class=post-meta-line><span title="发布于 2024-11-20 16:17:43"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2024.11.20>2024.11.20</time></span>&nbsp;<span title="更新于 2024-12-01 20:53:19"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2024.12.1>2024.12.1</time></span>&nbsp;<span title="2650 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 2700 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 6 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#下载>下载</a></li><li><a href=#配置>配置</a><ul><li><a href=#修改-python-版本>修改 python 版本</a></li></ul></li><li><a href=#插件>插件</a><ul><li><a href=#keypatch>keypatch</a></li><li><a href=#lazyida>lazyida</a></li><li><a href=#d810>D810</a></li><li><a href=#findcrypt-yara>findcrypt-yara</a></li><li><a href=#ipyida>ipyida</a></li><li><a href=#bindiff>bindiff</a></li></ul></li><li><a href=#使用>使用</a><ul><li><a href=#日常使用>日常使用</a><ul><li><a href=#主要操作>主要操作</a></li><li><a href=#插件操作>插件操作</a></li><li><a href=#类型更改>类型更改</a></li><li><a href=#动态调试>动态调试</a><ul><li><a href=#快捷键>快捷键</a></li><li><a href=#附加>附加</a></li><li><a href=#elf-文件>ELF 文件</a></li></ul></li></ul></li><li><a href=#idapython>idapython</a></li><li><a href=#相关技巧>相关技巧</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>记录一下 IDA 的使用。</p><h2 class=heading-element id=下载><span>下载</span>
<a href=#%e4%b8%8b%e8%bd%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>这里贴一个 IDA9.0rc1 的 <a href=https://bbs.kanxue.com/thread-283917.htm target=_blank rel="external nofollow noopener noreferrer">来源</a>，虽然不是从这里获取的资源，但是想来应该都差不多。之后就是使用评论区给出的 <code>keygen2.py</code> 文件进行 patch 和生成 License，也就是 <code>idapro.hexlic</code> 文件，这样就可以正常使用了。</p><h2 class=heading-element id=配置><span>配置</span>
<a href=#%e9%85%8d%e7%bd%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=修改-python-版本><span>修改 python 版本</span>
<a href=#%e4%bf%ae%e6%94%b9-python-%e7%89%88%e6%9c%ac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>想让 IDA 使用自己的 python，那么就需要进行相关配置，这里直接使用 <code>idapyswitch.exe</code> 进行切换即可，下面的命令就会更改 IDA 使用的 python 版本。我这里使用的是 miniconda 的虚拟环境，但是都是一样的，只要找到 <code>python3.dll</code> 就行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>.\</span><span class=n>idapyswitch</span><span class=p>.</span><span class=py>exe</span> <span class=p>-</span><span class=n>-force-path</span> <span class=n>E:</span><span class=p>\</span><span class=n>xxxxx</span><span class=p>\</span><span class=n>miniconda3</span><span class=p>\</span><span class=n>envs</span><span class=p>\</span><span class=n>re</span><span class=p>\</span><span class=n>python3</span><span class=p>.</span><span class=n>dll</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=插件><span>插件</span>
<a href=#%e6%8f%92%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>IDA 有很多好用的插件，但是按照之前 beta 的版本，有一些会产生冲突，所以这里记录目前可以使用或者被修改过的插件。</p><h3 class=heading-element id=keypatch><span>keypatch</span>
<a href=#keypatch class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>从 <a href=https://github.com/VNRev/awesome_ida_9_plugins/tree/main/keypatch target=_blank rel="external nofollow noopener noreferrer">修改仓库</a> 获取的，直接把 <code>keypatch.py</code> 放在 <code>plugins</code> 目录中就可以使用了。具体使用可以看链接的 README 文件</p><h3 class=heading-element id=lazyida><span>lazyida</span>
<a href=#lazyida class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>从 <a href=https://github.com/L4ys/LazyIDA target=_blank rel="external nofollow noopener noreferrer">官方仓库</a> 获取的，作者修改了错误的地方，配置方式和上面一样，具体使用也是看 README。</p><h3 class=heading-element id=d810><span>D810</span>
<a href=#d810 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>从 <a href=https://github.com/joydo/d810 target=_blank rel="external nofollow noopener noreferrer">官方仓库</a> 获取的，反正最开始的时候没有报错，当作可以正常使用 🐶。之后使用时选择适当的规则，然后点击 <code>start</code>，就可以按 F5 自动反编译，解决 OLLVM 混淆。如果已经存在 F5 缓存，可以将一段代码 nop 掉，之后撤销操作，再 F5 反编译即可</p><p><figure><a class=lightgallery href=https://nuthecz.oss-cn-hangzhou.aliyuncs.com/file/202401152139298.png title=20240115213925148 data-thumbnail=https://nuthecz.oss-cn-hangzhou.aliyuncs.com/file/202401152139298.png data-sub-html="<h2>D810使用</h2><p>20240115213925148</p>"><img loading=lazy src=https://nuthecz.oss-cn-hangzhou.aliyuncs.com/file/202401152139298.png alt=D810使用></a><figcaption class=image-caption>20240115213925148</figcaption></figure></p><h3 class=heading-element id=findcrypt-yara><span>findcrypt-yara</span>
<a href=#findcrypt-yara class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>从 <a href=https://github.com/polymorf/findcrypt-yara target=_blank rel="external nofollow noopener noreferrer">官方仓库</a> 获取之后，把 <code>findcrypt3.py</code> 和 <code>findcrypt3.rules</code> 放在 <code>plugins</code> 目录中。之后因为 yara-python 版本的问题，需要进行 <a href=https://blog.csdn.net/marosri/article/details/131171634 target=_blank rel="external nofollow noopener noreferrer">修正</a>，直接将下面的代码覆盖原来的即可。同时也可以给 rules <a href=https://blog.csdn.net/weixin_45055269/article/details/112688365 target=_blank rel="external nofollow noopener noreferrer">添加国密SM4算法的识别规则</a>。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>yarasearch</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>memory</span><span class=p>,</span> <span class=n>offsets</span><span class=p>,</span> <span class=n>rules</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&gt;&gt;&gt; start yara search&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>values</span> <span class=o>=</span> <span class=nb>list</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>matches</span> <span class=o>=</span> <span class=n>rules</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>memory</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=k>match</span> <span class=ow>in</span> <span class=n>matches</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>stringR</span> <span class=ow>in</span> <span class=k>match</span><span class=o>.</span><span class=n>strings</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=n>name</span> <span class=o>=</span> <span class=k>match</span><span class=o>.</span><span class=n>rule</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>string</span> <span class=ow>in</span> <span class=n>stringR</span><span class=o>.</span><span class=n>instances</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>if</span> <span class=n>name</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&#34;_API&#34;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=n>name</span> <span class=o>=</span> <span class=n>name</span> <span class=o>+</span> <span class=s2>&#34;_&#34;</span> <span class=o>+</span> <span class=n>idc</span><span class=o>.</span><span class=n>GetString</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>toVirtualAddress</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>offset</span><span class=p>,</span> <span class=n>offsets</span><span class=p>))</span>
</span></span><span class=line><span class=cl>                        <span class=k>except</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                            <span class=k>pass</span>
</span></span><span class=line><span class=cl>                    <span class=n>value</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>                        <span class=bp>self</span><span class=o>.</span><span class=n>toVirtualAddress</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>offset</span><span class=p>,</span> <span class=n>offsets</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                        <span class=k>match</span><span class=o>.</span><span class=n>namespace</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=n>name</span> <span class=o>+</span> <span class=s2>&#34;_&#34;</span> <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>toVirtualAddress</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>offset</span><span class=p>,</span> <span class=n>offsets</span><span class=p>))</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&#34;0x&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;L&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>upper</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>                        <span class=n>stringR</span><span class=o>.</span><span class=n>identifier</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                        <span class=nb>repr</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>matched_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>]</span>
</span></span><span class=line><span class=cl>                    <span class=n>idaapi</span><span class=o>.</span><span class=n>set_name</span><span class=p>(</span><span class=n>value</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>name</span>
</span></span><span class=line><span class=cl>                             <span class=o>+</span> <span class=s2>&#34;_&#34;</span>
</span></span><span class=line><span class=cl>                             <span class=o>+</span> <span class=nb>hex</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>toVirtualAddress</span><span class=p>(</span><span class=n>string</span><span class=o>.</span><span class=n>offset</span><span class=p>,</span> <span class=n>offsets</span><span class=p>))</span><span class=o>.</span><span class=n>lstrip</span><span class=p>(</span><span class=s2>&#34;0x&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34;L&#34;</span><span class=p>)</span><span class=o>.</span><span class=n>upper</span><span class=p>()</span>
</span></span><span class=line><span class=cl>                             <span class=p>,</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=n>values</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>value</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;&lt;&lt;&lt; end yara search&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>values</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=ipyida><span>ipyida</span>
<a href=#ipyida class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>可以在 IDA 中配置 <code>ipython</code> 来执行 python 代码。直接从 <a href=https://github.com/eset/ipyida target=_blank rel="external nofollow noopener noreferrer">官方仓库</a> 执行命令下载即可。然后使用 <code>Shift + .</code> 就可以打开进行使用了，注意 <code>exit</code> 的使用，它会直接退出 IDA，然后分析文件会遗留，但是是分散的格式。</p><h3 class=heading-element id=bindiff><span>bindiff</span>
<a href=#bindiff class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>直接去 <a href=https://zynamics.com/software.html target=_blank rel="external nofollow noopener noreferrer">官网</a> 下载 bindiff，我这里下载的是 <code>bindiff 8</code>。然后在它的 Plugins 目录下存在 IDA 的插件，我这里是找到 IDA-9.0-rc1 的 <a href=https://github.com/zhefox/Bindiff_for_IDA9.0 target=_blank rel="external nofollow noopener noreferrer">适配</a> 版本，直接放到 IDA 的 plugins 目录下，然后点击 File 就可以看到 bindiff 并使用了。</p><h2 class=heading-element id=使用><span>使用</span>
<a href=#%e4%bd%bf%e7%94%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>可以查看别人的 <a href=https://www.lyldalek.top/article/ida target=_blank rel="external nofollow noopener noreferrer">博客1</a>、<a href=https://skyi23.github.io/2024/11/11/IDA%20Python%20%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/#IDA-Python-%E5%B8%B8%E7%94%A8-API target=_blank rel="external nofollow noopener noreferrer">博客2</a>、<a href=https://xialuohun.top/posts/ida/idapython%E4%BD%BF%E7%94%A8/ target=_blank rel="external nofollow noopener noreferrer">博客3</a> 来学习具体的使用方法和小技巧。</p><h3 class=heading-element id=日常使用><span>日常使用</span>
<a href=#%e6%97%a5%e5%b8%b8%e4%bd%bf%e7%94%a8 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>这里补一下 IDA <a href=https://docs.hex-rays.com/user-guide/configuration/shortcuts target=_blank rel="external nofollow noopener noreferrer">官方快捷方式</a>，这个更为全面。</p><h4 class=heading-element id=主要操作><span>主要操作</span>
<a href=#%e4%b8%bb%e8%a6%81%e6%93%8d%e4%bd%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ol><li><code>ctrl + e</code>：找到main函数</li><li><code>Shift + f12</code>：可以打开 string 窗口，一键找出所有的字符串，右击 setup，对窗口的属性进行设置。同时附加时使用可以显示 strings</li><li><code>Shift + f7</code>：可以查看 Segments 窗口。查看不同的段</li><li><code>空格</code>：在 Text View 和 Group View 中来回切换</li><li><code>f5/Tab</code>：一键反汇编，Tab 可以在汇编界面与伪代码界面来回切换</li><li><code>Ctrl + X</code>：交叉引用</li><li><code>Alt + T</code>：在汇编界面中搜索汇编语言</li><li><code>Shift + E</code>：提取数据</li><li><code>Ctrl + Shift + W</code>：保存快照，它会生成一个新的 ida 数据库文件，本质为另存为</li></ol><h4 class=heading-element id=插件操作><span>插件操作</span>
<a href=#%e6%8f%92%e4%bb%b6%e6%93%8d%e4%bd%9c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ol><li><code>Ctrl + Alt + K</code>：(Keypatch快捷键) 进行patch</li><li><code>Shift + .</code>：打开 ipyida 插件</li></ol><h4 class=heading-element id=类型更改><span>类型更改</span>
<a href=#%e7%b1%bb%e5%9e%8b%e6%9b%b4%e6%94%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><ol><li><p><code>D</code> 转换为原始数据</p><p><code>C</code> 转换为汇编代码</p><p><code>P</code> 重新生成函数</p><p><code>a</code> 将数据转换为字符串，主要可以应对小端序存储</p></li><li><p><code>N</code> 更改变量的名称</p><p><code>Y</code> 更改变量的类型，比如把 <code>_int64</code> 更正为 <code>BYTE*</code>（或者 <code>char *</code>）</p><p><code>U</code> undefine，取消定义函数、代码、数据的定义，转化为原始字节的形式</p><p><code>V</code> 简化函数的格式，有时候函数没有 return 时可以使用，查看更方便</p><p><code>M</code> 枚举所有相同的数据</p></li><li><p><code>;</code> 在反汇编后的界面中写下注释</p><p><code>/</code> 在反编译后伪代码的界面中写下注释</p></li><li><p><code>\</code> 在反编译后伪代码的界面中隐藏/显示变量和函数的类型描述</p><ul><li>有时候变量特别多的时候隐藏掉类型描述看起来会轻松很多</li><li>右键点击 <code>Hide casts</code> 也可以隐藏类似 <code>*(DWORD)</code> 的类型描述</li></ul></li></ol><h4 class=heading-element id=动态调试><span>动态调试</span>
<a href=#%e5%8a%a8%e6%80%81%e8%b0%83%e8%af%95 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h4><h5 class=heading-element id=快捷键><span>快捷键</span>
<a href=#%e5%bf%ab%e6%8d%b7%e9%94%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><ol><li><code>F2</code> 增加断点</li><li><code>F7</code> 单步步入，遇到函数，将进入函数代码内部</li><li><code>F8</code> 单步步过，执行下一条指令，不进入函数代码内部</li><li><code>F4</code> 运行到光标处（断点处）</li><li><code>F9</code> 继续运行</li><li><code>Ctrl + F2</code> 终止一个正在运行的调试进程，重新开始调试</li><li><code>Ctrl + F7</code> 自动步入，在所有的函数调用中一条一条地执行命令，断点或异常时，自动停止</li><li><code>Ctrl + F8</code> 自动步过，一条一条的执行命令，程序到达断点，或者发生异常时，自动步过过程都会停止</li></ol><h5 class=heading-element id=附加><span>附加</span>
<a href=#%e9%99%84%e5%8a%a0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><p>应对一些强壳，可以先启动 <code>.exe</code> 程序，之后使用IDA的附加功能 <code>(Debugger->attach)</code>，附加进程，可以越过壳。之后可以使用 <code>Shift + f12</code> 和 <code>Shift + f7</code> 定位关键字符位置和段属性，将该程序的 Code 段使用 IDAPYTHON 转化为反汇编形式进行动调。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>ida_ua</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl><span class=n>cur_addr</span> <span class=o>=</span> <span class=mh>0x401000</span>   <span class=c1>#起始地址</span>
</span></span><span class=line><span class=cl><span class=n>end_addr</span> <span class=o>=</span> <span class=mh>0x410000</span>   <span class=c1>#终止地址</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_insn</span><span class=p>(</span><span class=n>start</span><span class=p>,</span><span class=n>end</span><span class=p>):</span>
</span></span><span class=line><span class=cl>	<span class=n>adr</span> <span class=o>=</span> <span class=n>start</span>
</span></span><span class=line><span class=cl>	<span class=n>out_ins</span> <span class=o>=</span> <span class=n>insn_t</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>		<span class=k>if</span><span class=p>(</span><span class=n>adr</span> <span class=o>&gt;=</span> <span class=n>end</span><span class=p>):</span> 
</span></span><span class=line><span class=cl>			<span class=k>break</span>
</span></span><span class=line><span class=cl>		<span class=n>create_insn</span><span class=p>(</span><span class=n>adr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>size</span> <span class=o>=</span> <span class=n>decode_insn</span><span class=p>(</span><span class=n>out_ins</span><span class=p>,</span><span class=n>adr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=n>adr</span> <span class=o>+=</span> <span class=n>size</span>
</span></span><span class=line><span class=cl>	<span class=nb>print</span><span class=p>(</span><span class=s2>&#34;end!&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>make_insn</span><span class=p>(</span><span class=n>cur_addr</span><span class=p>,</span><span class=n>end_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Done&#34;</span><span class=p>)</span></span></span></code></pre></td></tr></table></div></div><blockquote><p>可能 Code 段很大，编译很慢，可以结合手动按c反汇编结合查看</p></blockquote><h5 class=heading-element id=elf-文件><span>ELF 文件</span>
<a href=#elf-%e6%96%87%e4%bb%b6 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h5><blockquote><p>以下就是注意事项，具体流程直接上网查找即可。</p></blockquote><ul><li>Linux开启远程连接服务，在虚拟机中打开 IDA 在 Linux 中的调试工具</li><li>首先需要将文件提权，否则不能运行，也就不能调试了</li><li>IDA连接虚拟机，开始动调</li><li>Linux进行附加时，需要先打开 linux_server 服务，然后另起端口打开运行的程序，之后就可以附加了。这里需要先使用 <code>sudo vim /etc/sysctl.d/10-ptrace.conf</code> 更改最后一行 <code>kernel.yama.ptrace_scope = 0</code>，重启系统后，普通用户就可以使用 attach ID 连接程序调试了。</li><li>注意 wsl 的 <code>Hosrname</code> 可以设置为 <code>127.0.0.1</code>，有时候设置成 wsl 的 ip 不太起效果</li><li>为了方便 IDA 中的 application，可以使用 <code>realpath ./file</code> 直接获取文件的路径</li></ul><h3 class=heading-element id=idapython><span>idapython</span>
<a href=#idapython class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>idapython 可以对相关数据进行操作，学习可以参照下面的文章。</p><ul><li><a href=https://skyi23.github.io/2024/11/11/IDA%20Python%20%E4%BD%BF%E7%94%A8%E6%80%BB%E7%BB%93/#ida-python-%E5%B8%B8%E7%94%A8-api target=_blank rel="external nofollow noopener noreferrer">IDA Python 使用总结</a></li></ul><h3 class=heading-element id=相关技巧><span>相关技巧</span>
<a href=#%e7%9b%b8%e5%85%b3%e6%8a%80%e5%b7%a7 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li>从IDA中获取数据时，如果在分析程序中发现数据的排列为 <code>qword</code> 等，建议不要以小端序转化，而是直接从 IDA 的 <code>IDA View-RIP</code> 界面复制，不用 <code>Ctrl + e</code> 提取数据。除此之外， <code>qword</code> 的转化可能会出现一些多余数据，记得识别</li></ol><ul><li>这里补充一点：若是在 <code>IDA View-RIP</code> 界面中的数据不是正规数据（这里指十六进制），则采用 <code>Ctrl + e</code> 进行十六进制提取，再分别以4个字节为一组，然后倒转称为小端序的顺序进行解密操作</li><li>总而言之<ol><li><p>可以首先使用 <code>Ctrl + e</code> 进行提取，然后手动进行倒转转换</p></li><li><p>也可以使用 <code>D</code> 进行打乱，再分别使用 <code>D</code> 聚合成每4个字节为一组的形式</p></li><li><p>也可以使用插件 <code>lazyida</code>，在数据上 <code>右键</code> -> <code>convert</code> -> <code>Covern to …… DWORD list</code>（这里注意看前面的标识进行相依字节长度的转化）就可以在下方output框看见正确的小端序数组</p></li></ol></li></ul><ol start=2><li><p><code>Patch</code> 函数的时候，可以直接使用汇编。然后另存为文件即可跳过函数</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-nasm data-lang=nasm><span class=line><span class=cl><span class=nf>mov</span> <span class=nb>eax</span><span class=p>,</span><span class=mh>0x1</span>
</span></span><span class=line><span class=cl><span class=nf>retn</span> <span class=nv>x</span>      <span class=c1>;这里的 x 需要根据函数末尾的返回来抄写，防止栈不平衡</span></span></span></code></pre></td></tr></table></div></div></li><li><p>遇到 <code>(_BYTE *)&amp;qword_4058</code> 之类的，若是知道这是表示的数组，那么可以再汇编界面按 <code>D</code> 变成数据，之后 <code>F5</code> 重新生成伪代码，则可以看到数组变成 <code>byte_4058[]</code> 之类的数组形式</p></li><li><p>若是函数格式中有 <code>(_BYTE)</code> 等干扰分析时，可以：</p><ul><li>使用 <code>Y</code> 更改变量的类型，比如把 <code>_int64</code> 更正为 <code>BYTE*</code>或者 (<code>char *</code>)</li><li>使用 <code>V</code> 简化函数的格式，有时候函数没有 <code>return</code> 时可以使用，这样看更方便</li></ul></li><li><p>IDA在识别花指令时，很可能在一个连续的函数中显示红色的 <code>sub_3D9 endp ; sp-analysis failed</code> 类似的信息，这个时候可以使用 <code>Edit -> Function -> Delete function</code> 删除函数定义，然后在正确的位置 <code>retn</code> 使用 <code>Edit -> Function -> Set function end</code> 设置函数结尾。之后 <code>F5</code> 反编译可以看到正常的函数</p></li><li><p>有时候 <code>U</code> + <code>P</code> 不能生成函数，可以先删除函数定义，选中函数块之后按 <code>P</code> 定义函数</p></li></ol></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2024-12-01 20:53:19">更新于 2024.12.1&nbsp;<a class=git-hash href=https://github.com/czTangt/blog.git/commit/0ce85af5a93b42478443104430b5bdc3a296dffb rel="external nofollow noopener noreferrer" target=_blank title="add content to IDA&#10&#10Commit: 0ce85af5a93b42478443104430b5bdc3a296dffb [0ce85af]&#10Author: czTangt&#10Date: 2024-12-01 20:53:19"><i class="fa-solid fa-hashtag fa-fw" aria-hidden=true></i>0ce85af</a></span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href="https://github.com/czTangt/blog.git/blob/main/content/posts/config/IDA.md?plain=1" title=查看源码 target=_blank rel="external nofollow noopener noreferrer" class=link-to-source>查看源码</a></span><span><a href=https://github.com/czTangt/blog.git/edit/main/content/posts/config/IDA.md title=编辑此页 target=_blank rel="external nofollow noopener noreferrer" class=link-to-edit>编辑此页</a></span><span><a href="https://github.com/czTangt/blog.git/issues/new?title=[BUG]%20IDA+%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8&amp;body=%7cField%7cValue%7c%0A%7c-%7c-%7c%0A%7cTitle%7cIDA+%E9%85%8D%E7%BD%AE%E5%92%8C%E4%BD%BF%E7%94%A8%7c%0A%7cURL%7chttps://czTangt.github.io/blog/posts/config/ida/%7c%0A%7cFilename%7chttps://github.com/czTangt/blog.git/blob/main/content/posts/config/IDA.md?plain=1%7c" title=报告问题 target=_blank rel="external nofollow noopener noreferrer" class=link-to-report>报告问题</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://czTangt.github.io/blog/posts/config/ida/ data-title="IDA 配置和使用" data-hashtags=config><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://czTangt.github.io/blog/posts/config/ida/ data-hashtag=config><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://czTangt.github.io/blog/posts/config/ida/ data-title="IDA 配置和使用"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/blog/tags/config/ class=post-tag title="标签 - Config">Config</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/blog/>主页</a></span></section></div><div class=post-nav><a href=/blog/posts/course/compilers-lab/ class=post-nav-item rel=prev title="Compilers Lab"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Compilers Lab</a><a href=/blog/posts/android/elf/ class=post-nav-item rel=next title="ELF 解析">ELF 解析<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.150.0"><img class=hugo-icon src=/blog/images/hugo.min.svg alt="Hugo logo"> Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.1"><img class=fixit-icon src=/blog/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2024 - 2025</span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><a href=https://github.com/czTangt/blog title="View source on GitHub" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true" width="56" height="56"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentColor" class="octo-body"/></svg></a><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/blog/lib/lightgallery/css/lightgallery-bundle.min.css><link rel=stylesheet href=/blog/lib/cookieconsent/cookieconsent.min.css><script src=/blog/lib/autocomplete/autocomplete.min.js defer></script><script src=/blog/lib/fuse/fuse.min.js defer></script><script src=/blog/lib/lightgallery/lightgallery.min.js defer></script><script src=/blog/lib/lightgallery/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=/blog/lib/lightgallery/plugins/zoom/lg-zoom.min.js defer></script><script src=/blog/lib/sharer/sharer.min.js async defer></script><script src=/blog/js/lib/mathjax.min.js async defer></script><script src=/blog/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/blog/js/codeblock.js defer></script><script src=https://libs.baidu.com/jquery/2.1.4/jquery.min.js defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},lightgallery:!0,search:{distance:100,findAllMatches:!1,fuseIndexURL:"/blog/search.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!1,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:30,threshold:.3,type:"fuse",useExtendedSearch:!1},version:"v0.4.0-alpha.1"}</script><script src=/blog/js/theme.min.js defer></script></body></html>